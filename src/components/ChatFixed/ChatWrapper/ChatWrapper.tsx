import React, {useCallback, useContext, useState,useEffect,FC} from 'react';
import {ContainerWrapper, Svg} from "./ChatWrapperStyled";
import mobileContext from "../mobileContext";
import {useDocumentVisibility} from "@artioki/react-document-visibility-and-responsive";

interface chatFixedInterface{
  visibleWindow:boolean,
  setVisibleWindow:(value: (((prevState: boolean) => boolean) | boolean)) => void
}

const ChatWrapper:FC<chatFixedInterface> = ({visibleWindow,setVisibleWindow}) =>{
  const { count, visible, onVisibilityChange } = useDocumentVisibility();
  const [firstHover, setFirstHover] = useState(false);
  const mobile = useContext(mobileContext);


  const clickHandler = useCallback(
      () => {
        setVisibleWindow( state => !state );

      },
      [setVisibleWindow],
  );
  useEffect(() => {
    onVisibilityChange(isVisible => {
      setFirstHover(!isVisible);
    })
  }, [setFirstHover])
  
  return (
    <>
    <ContainerWrapper mobile={Boolean(mobile)} visible={visibleWindow}>
      <button onMouseEnter={()=> setFirstHover(true)}  onClick={clickHandler}>
        {visible
          ?
          firstHover ?
              visibleWindow ?
              <svg className={'animationSwing'} style={{marginTop:'-7px'}} width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 2L14 14" stroke="white" strokeWidth="2.5" strokeLinecap="round"/>
                <path d="M14 2L2 14" stroke="white" strokeWidth="2.5" strokeLinecap="round"/>
              </svg>
              :
              <svg className={'animationRotate'}  width="24" height="30" viewBox="0 0 24 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11 26L4 30V26H2C1.46957 26 0.960859 25.7893 0.585786 25.4142C0.210714 25.0391 0 24.5304 0 24V1C0 0.734784 0.105357 0.48043 0.292893 0.292893C0.48043 0.105357 0.734784 0 1 0H23C23.2652 0 23.5196 0.105357 23.7071 0.292893C23.8946 0.48043 24 0.734784 24 1V24C24 24.5304 23.7893 25.0391 23.4142 25.4142C23.0391 25.7893 22.5304 26 22 26H11Z" fill="white"/>
              </svg>
            :
            <>
              <Svg className={'animationOpacityForwards'} delay={0} time={0.5} width="24" height="30" viewBox="0 0 24 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11 26L4 30V26H2C1.46957 26 0.960859 25.7893 0.585786 25.4142C0.210714 25.0391 0 24.5304 0 24V1C0 0.734784 0.105357 0.48043 0.292893 0.292893C0.48043 0.105357 0.734784 0 1 0H23C23.2652 0 23.5196 0.105357 23.7071 0.292893C23.8946 0.48043 24 0.734784 24 1V24C24 24.5304 23.7893 25.0391 23.4142 25.4142C23.0391 25.7893 22.5304 26 22 26H11Z" fill="white"/>
              </Svg>
              <Svg style={{marginTop:'-10px'}} className={'animationOpacity'} delay={1} time={2}  width="19" height="15" viewBox="0 0 19 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fillRule="evenodd" clipRule="evenodd" d="M6.315 0.387024H17.315C17.5802 0.387024 17.8346 0.492381 18.0221 0.679917C18.2096 0.867454 18.315 1.12181 18.315 1.38702C18.315 1.65224 18.2096 1.90659 18.0221 2.09413C17.8346 2.28167 17.5802 2.38702 17.315 2.38702H6.315C6.04979 2.38702 5.79543 2.28167 5.6079 2.09413C5.42036 1.90659 5.315 1.65224 5.315 1.38702C5.315 1.12181 5.42036 0.867454 5.6079 0.679917C5.79543 0.492381 6.04979 0.387024 6.315 0.387024ZM1.315 4.38702H17.315C17.5802 4.38702 17.8346 4.49238 18.0221 4.67992C18.2096 4.86745 18.315 5.12181 18.315 5.38702C18.315 5.65224 18.2096 5.90659 18.0221 6.09413C17.8346 6.28167 17.5802 6.38702 17.315 6.38702H1.315C1.04979 6.38702 0.795432 6.28167 0.607896 6.09413C0.420359 5.90659 0.315002 5.65224 0.315002 5.38702C0.315002 5.12181 0.420359 4.86745 0.607896 4.67992C0.795432 4.49238 1.04979 4.38702 1.315 4.38702ZM6.315 12.387H17.315C17.5802 12.387 17.8346 12.4924 18.0221 12.6799C18.2096 12.8675 18.315 13.1218 18.315 13.387C18.315 13.6522 18.2096 13.9066 18.0221 14.0941C17.8346 14.2817 17.5802 14.387 17.315 14.387H6.315C6.04979 14.387 5.79543 14.2817 5.6079 14.0941C5.42036 13.9066 5.315 13.6522 5.315 13.387C5.315 13.1218 5.42036 12.8675 5.6079 12.6799C5.79543 12.4924 6.04979 12.387 6.315 12.387ZM11.315 8.38702H17.315C17.5802 8.38702 17.8346 8.49238 18.0221 8.67992C18.2096 8.86745 18.315 9.12181 18.315 9.38702C18.315 9.65224 18.2096 9.90659 18.0221 10.0941C17.8346 10.2817 17.5802 10.387 17.315 10.387H11.315C11.0498 10.387 10.7954 10.2817 10.6079 10.0941C10.4204 9.90659 10.315 9.65224 10.315 9.38702C10.315 9.12181 10.4204 8.86745 10.6079 8.67992C10.7954 8.49238 11.0498 8.38702 11.315 8.38702Z" fill="#0848C0"/>
              </Svg>
              <Svg style={{marginTop:'-10px'}} className={'animationOpacity'} delay={3} time={1} width="19" height="11" viewBox="0 0 19 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fillRule="evenodd" clipRule="evenodd" d="M1.315 0.387024H17.315C17.5802 0.387024 17.8346 0.492381 18.0221 0.679917C18.2096 0.867454 18.315 1.12181 18.315 1.38702C18.315 1.65224 18.2096 1.90659 18.0221 2.09413C17.8346 2.28167 17.5802 2.38702 17.315 2.38702H1.315C1.04979 2.38702 0.795432 2.28167 0.607896 2.09413C0.420359 1.90659 0.315002 1.65224 0.315002 1.38702C0.315002 1.12181 0.420359 0.867454 0.607896 0.679917C0.795432 0.492381 1.04979 0.387024 1.315 0.387024ZM1.315 4.38702H7.315C7.58022 4.38702 7.83457 4.49238 8.02211 4.67992C8.20965 4.86745 8.315 5.12181 8.315 5.38702C8.315 5.65224 8.20965 5.90659 8.02211 6.09413C7.83457 6.28167 7.58022 6.38702 7.315 6.38702H1.315C1.04979 6.38702 0.795432 6.28167 0.607896 6.09413C0.420359 5.90659 0.315002 5.65224 0.315002 5.38702C0.315002 5.12181 0.420359 4.86745 0.607896 4.67992C0.795432 4.49238 1.04979 4.38702 1.315 4.38702ZM1.315 8.38702H12.315C12.5802 8.38702 12.8346 8.49238 13.0221 8.67992C13.2096 8.86745 13.315 9.12181 13.315 9.38702C13.315 9.65224 13.2096 9.90659 13.0221 10.0941C12.8346 10.2817 12.5802 10.387 12.315 10.387H1.315C1.04979 10.387 0.795432 10.2817 0.607896 10.0941C0.420359 9.90659 0.315002 9.65224 0.315002 9.38702C0.315002 9.12181 0.420359 8.86745 0.607896 8.67992C0.795432 8.49238 1.04979 8.38702 1.315 8.38702Z" fill="#0848C0"/>
              </Svg>
            </>
          :
          <>
            <Svg className={'animationOpacityForwards'} delay={0} time={1} width="24" height="30" viewBox="0 0 24 30" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11 26L4 30V26H2C1.46957 26 0.960859 25.7893 0.585786 25.4142C0.210714 25.0391 0 24.5304 0 24V1C0 0.734784 0.105357 0.48043 0.292893 0.292893C0.48043 0.105357 0.734784 0 1 0H23C23.2652 0 23.5196 0.105357 23.7071 0.292893C23.8946 0.48043 24 0.734784 24 1V24C24 24.5304 23.7893 25.0391 23.4142 25.4142C23.0391 25.7893 22.5304 26 22 26H11Z" fill="white"/>
            </Svg>
            <Svg style={{marginTop:'-10px'}} className={'animationOpacity'} delay={1} time={2}  width="19" height="15" viewBox="0 0 19 15" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fillRule="evenodd" clipRule="evenodd" d="M6.315 0.387024H17.315C17.5802 0.387024 17.8346 0.492381 18.0221 0.679917C18.2096 0.867454 18.315 1.12181 18.315 1.38702C18.315 1.65224 18.2096 1.90659 18.0221 2.09413C17.8346 2.28167 17.5802 2.38702 17.315 2.38702H6.315C6.04979 2.38702 5.79543 2.28167 5.6079 2.09413C5.42036 1.90659 5.315 1.65224 5.315 1.38702C5.315 1.12181 5.42036 0.867454 5.6079 0.679917C5.79543 0.492381 6.04979 0.387024 6.315 0.387024ZM1.315 4.38702H17.315C17.5802 4.38702 17.8346 4.49238 18.0221 4.67992C18.2096 4.86745 18.315 5.12181 18.315 5.38702C18.315 5.65224 18.2096 5.90659 18.0221 6.09413C17.8346 6.28167 17.5802 6.38702 17.315 6.38702H1.315C1.04979 6.38702 0.795432 6.28167 0.607896 6.09413C0.420359 5.90659 0.315002 5.65224 0.315002 5.38702C0.315002 5.12181 0.420359 4.86745 0.607896 4.67992C0.795432 4.49238 1.04979 4.38702 1.315 4.38702ZM6.315 12.387H17.315C17.5802 12.387 17.8346 12.4924 18.0221 12.6799C18.2096 12.8675 18.315 13.1218 18.315 13.387C18.315 13.6522 18.2096 13.9066 18.0221 14.0941C17.8346 14.2817 17.5802 14.387 17.315 14.387H6.315C6.04979 14.387 5.79543 14.2817 5.6079 14.0941C5.42036 13.9066 5.315 13.6522 5.315 13.387C5.315 13.1218 5.42036 12.8675 5.6079 12.6799C5.79543 12.4924 6.04979 12.387 6.315 12.387ZM11.315 8.38702H17.315C17.5802 8.38702 17.8346 8.49238 18.0221 8.67992C18.2096 8.86745 18.315 9.12181 18.315 9.38702C18.315 9.65224 18.2096 9.90659 18.0221 10.0941C17.8346 10.2817 17.5802 10.387 17.315 10.387H11.315C11.0498 10.387 10.7954 10.2817 10.6079 10.0941C10.4204 9.90659 10.315 9.65224 10.315 9.38702C10.315 9.12181 10.4204 8.86745 10.6079 8.67992C10.7954 8.49238 11.0498 8.38702 11.315 8.38702Z" fill="#0848C0"/>
            </Svg>
            <Svg style={{marginTop:'-10px'}} className={'animationOpacity'} delay={3} time={1} width="19" height="11" viewBox="0 0 19 11" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fillRule="evenodd" clipRule="evenodd" d="M1.315 0.387024H17.315C17.5802 0.387024 17.8346 0.492381 18.0221 0.679917C18.2096 0.867454 18.315 1.12181 18.315 1.38702C18.315 1.65224 18.2096 1.90659 18.0221 2.09413C17.8346 2.28167 17.5802 2.38702 17.315 2.38702H1.315C1.04979 2.38702 0.795432 2.28167 0.607896 2.09413C0.420359 1.90659 0.315002 1.65224 0.315002 1.38702C0.315002 1.12181 0.420359 0.867454 0.607896 0.679917C0.795432 0.492381 1.04979 0.387024 1.315 0.387024ZM1.315 4.38702H7.315C7.58022 4.38702 7.83457 4.49238 8.02211 4.67992C8.20965 4.86745 8.315 5.12181 8.315 5.38702C8.315 5.65224 8.20965 5.90659 8.02211 6.09413C7.83457 6.28167 7.58022 6.38702 7.315 6.38702H1.315C1.04979 6.38702 0.795432 6.28167 0.607896 6.09413C0.420359 5.90659 0.315002 5.65224 0.315002 5.38702C0.315002 5.12181 0.420359 4.86745 0.607896 4.67992C0.795432 4.49238 1.04979 4.38702 1.315 4.38702ZM1.315 8.38702H12.315C12.5802 8.38702 12.8346 8.49238 13.0221 8.67992C13.2096 8.86745 13.315 9.12181 13.315 9.38702C13.315 9.65224 13.2096 9.90659 13.0221 10.0941C12.8346 10.2817 12.5802 10.387 12.315 10.387H1.315C1.04979 10.387 0.795432 10.2817 0.607896 10.0941C0.420359 9.90659 0.315002 9.65224 0.315002 9.38702C0.315002 9.12181 0.420359 8.86745 0.607896 8.67992C0.795432 8.49238 1.04979 8.38702 1.315 8.38702Z" fill="#0848C0"/>
            </Svg>
          </>
        }
      </button>
    </ContainerWrapper>
    </>
  );
}

export default ChatWrapper;